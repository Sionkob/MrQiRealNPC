#### English | [PortuguÃªs](./README-PT.md)

# Mister Qi is a Real NPC
[Mister Qi is a Real NPC](https://www.nexusmods.com/stardewvalley/mods/16724) is a Content patcher mod that turns Mister Qi into a giftable NPC by adding him as a custom NPC. The mod brings a new history to the character while respecting Mister Qi's original personality.

# Requirements
Currently, this mod only needs one mod to work:
- [Content Patcher](https://www.nexusmods.com/stardewvalley/mods/1915) - By Pathoschild

# Installing instructions
To install the mod, just copy it to your game's Mods folder. To uninstall it, just remove the **[CP] Mister Qi is a Real NPC** folder from your Mods folder.

# What is currently working?
The mod is under development and some things are not completed yet, but some things are already working, for example:
- Mr. Qi is recognized as a giftable NPC by the game.
- There are new dialogues up to 8 hearts.
- There are 6 events ready, 4 of them are heart events.
- 2 new maps have been added.
- Mr. Qi appears at every vanilla festival when you meet him.
- The schedules have been modified (but still incomplete).
- New dialogues for Mr. Qi who stays inside the Walnut Room have been added.
- Sandy talks about Mr. Qi and the casino when you become a club member.
- Now the mod is fully compatible with Stardew Valley 1.6.

As the mod is updated, more functions will be added, removed, or modified.

# What does not work/is not 100% ready?
Currently there are a few things that are not complete yet, I will finish them as soon as possible:
- The schedules are incomplete.
- You cannot invite him to watch a movie.
- The 10 hearts dialogues are missing.
- The 10 hearts event is missing.

In my testing, there's nothing that isn't working, there are just some incomplete features that will be completed as updates roll out. If you have any suggestions or find any bugs, feel free to comment on the Nexus Mods [posts](https://www.nexusmods.com/stardewvalley/mods/16724?tab=posts) page.

# More Details
Here are some details about what is currently added, some things may change in the course of updates.

## Mod Settings
This mod brings a setting, which can be changed when you open the game for the first time after installing the mod:

#### Kid or Name
This setting allows you to change the way Mr. Qi will refer to you in some dialogues, he may refer to you as "Kid" or your farmer's name. By default, it uses your farmer's name.

## New Maps
This mod adds 2 new maps to the game: Mr. Qi's room and a small laboratory.

### Mr. Qi's room map:
> ![QiRoom](https://github.com/Sionkob/MrQiRealNPC/assets/135146475/50b72d08-9915-4ff7-8b88-aad040267e2e)

Mr. Qi's room can be accessed through a corridor in the Casino.

### Lab map:
> ![QiLab](https://github.com/Sionkob/MrQiRealNPC/assets/135146475/893a2c2e-0f97-4b30-981c-9545d42ee1da)

The entrance to Mr. Qi's laboratory is at the door in the center of the small hallway in his room. The laboratory can only be accessed when the player has 6 hearts or more with Mr. Qi. If the player doesn't have enough hearts, the entrance to Mr. Qi's laboratory will be closed with an invisible wall that prevents the player from passing through.

## Events
Currently there are 4 events added, 2 of them are heart events, more events will be added over time. These are the preconditions to trigger each event:

#### Event #1
Enter the Casino after obtaining the [Club Card](https://stardewvalleywiki.com/Club_Card).

#### Event #2
After reaching level 100 of the [Skull Cavern](https://stardewvalleywiki.com/Skull_Cavern) after reading [Secret Note #10](https://stardewvalleywiki.com/Secret_Notes#Secret_Note_.2310), return to the entrance of the Skull Cavern.

#### Event #3
Having 2 hearts with Mr. Qi, enter the [Casino](https://stardewvalleywiki.com/Casino) at any time.

#### Event #4
Having 4 hearts with Mr. Qi, enter the [Oasis](https://stardewvalleywiki.com/Oasis) between 9AM and 9PM

#### Event #5
Having 6 hearts with Mr. Qi, entre the Mr. Qi Room between 5PM and 8:50PM.

**Note: If you weren't able to see this event completely because of the invisible wall preventing passage, install the [Event Lookup](https://www.nexusmods.com/stardewvalley/mods/8505) mod to remove it from the list of seen events to be able to see it again.**

#### Event #6
When you reach 8 hearts with Mr. Qi, the next day Mr. Qi will send you a letter inviting you to come to his room during the night, before the [Oasis](https://stardewvalleywiki.com/Oasis) closes, since there's an important thing he wants to talk to you about.

After reading this letter, you must enter Mr. Qi Room between 7pm and 11:40pm. 

<details>
	<summary>Details (spoiler)</summary>

The farmer is called by Mr. Qi, who reveals that he is a manifestation of a consciousness passed down through the ages. He explains that there have been other Misters Qi before him and that their mission is ensure the balance of resources in the world. Mr. Qi reveals that he has semi-physical, spiritual and extra-physical representations, each one is controlled by him and has specific functions, which help him fulfill his mission. The farmer is introduced to some of these representations, and at the end, Mr. Qi expresses relief that he no longer needs to hide the truth. 

In response to the revelation, the farmer can react in two ways:

**I'm kind of... I'm scared of you.** *(-5 friendship)*

The farmer expresses fear towards Mr. Qi. Mr. Qi explains that he observes everyone with good intentions and uses this to get to know the needs of people in Stardew Valley. Despite the farmer's fear, Mr. Qi assures that he's there to help.

**You can be in several places at once, you can control the world around you, you're not the first Mister Qi and now you observe and create challenges for me. It's so much to process...** *(No effect on friendship)*

The farmer expresses difficulty in processing all the information revealed about Mr. Qi. Mr. Qi recognizes the complexity of the topic and admits that it may have been a mistake to reveal everything at once. He emphasizes that the intention was never to scare the player, but to share the truth.

Regardless of the choice, Mr. Qi explains his interest in the farmer, revealing a promise made to the farmer's grandfather to guide and motivate the farmer's journey in Stardew Valley. And he encourages the farmer to continue exploring the valley to reach the perfection.
 
</details>


## Schedules
Mr. Qi's current schedule is as follows:

##### Spring

| Time     | Location                                                                                                                                                   |
|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 6:00 AM  | In his room.                                                                                                                                               |
| 7:00 AM  | In the [Casino](https://stardewvalleywiki.com/Casino).                                                                                                     |
| 4:00 PM  | In the Laboratory.                                                                                                                                         |
| 6:00 PM  | Still in the Laboratory.                                                                                                                                   |
| 8:00 PM  | Still in the Laboratory. (If you enter [Mr. Qi's Walnut Room](https://stardewvalleywiki.com/Qi%27s_Walnut_Room) on Ginger Island, you will also find him). |
| 12:20 AM | Returns to the room to sleep.                                                                                                                              |

##### Summer

| Time     | Location                                                                                                                                                   |
|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 6:00 AM  | In his room.                                                                                                                                               |
| 7:00 AM  | In the [Casino](https://stardewvalleywiki.com/Casino).                                                                                                     |
| 4:00 PM  | In the Laboratory.                                                                                                                                         |
| 6:00 PM  | Still in the Laboratory.                                                                                                                                   |
| 8:00 PM  | Still in the Laboratory. (If you enter [Mr. Qi's Walnut Room](https://stardewvalleywiki.com/Qi%27s_Walnut_Room) on Ginger Island, you will also find him). |
| 12:20 AM | Returns to the room to sleep.                                                                                                                              |

##### Fall

| Time     | Location                                                                                                                                                   |
|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 6:00 AM  | In his room.                                                                                                                                               |
| 7:00 AM  | In the [Casino](https://stardewvalleywiki.com/Casino).                                                                                                     |
| 1:00 PM  | In the [Desert](https://stardewvalleywiki.com/The_Desert), watching the Southern Pond.                                                                     |
| 5:00 PM  | In the Laboratory.                                                                                                                                         |
| 8:00 PM  | Still in the Laboratory. (If you enter [Mr. Qi's Walnut Room](https://stardewvalleywiki.com/Qi%27s_Walnut_Room) on Ginger Island, you will also find him). |
| 12:20 AM | Returns to the room to sleep.                                                                                                                              |

**Fall 15**

| Time     | Location                                                                                                                                                   |
|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 6:00 AM  | In his room.                                                                                                                                               |
| 7:00 AM  | In the [Casino](https://stardewvalleywiki.com/Casino).                                                                                                     |
| 4:00 PM  | In the Laboratory.                                                                                                                                         |
| 6:00 PM  | Still in the Laboratory.                                                                                                                                   |
| 8:00 PM  | Still in the Laboratory. (If you enter [Mr. Qi's Walnut Room](https://stardewvalleywiki.com/Qi%27s_Walnut_Room) on Ginger Island, you will also find him). |
| 12:20 AM | Returns to the room to sleep.                                                                                                                              |

##### Winter

| Time     | Location                                                                                                                                                   |
|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 6:00 AM  | In his room.                                                                                                                                               |
| 7:00 AM  | In the [Casino](https://stardewvalleywiki.com/Casino).                                                                                                     |
| 4:00 PM  | In the Laboratory.                                                                                                                                         |
| 6:00 PM  | Still in the Laboratory.                                                                                                                                   |
| 8:00 PM  | Still in the Laboratory. (If you enter [Mr. Qi's Walnut Room](https://stardewvalleywiki.com/Qi%27s_Walnut_Room) on Ginger Island, you will also find him). |
| 12:20 AM | Returns to the room to sleep.                                                                                                                              |

**Winter 17 (After seeing Mr. Qi's 6 heart event)**

| Time    | Location                                                                                                                                       |
|---------|------------------------------------------------------------------------------------------------------------------------------------------------|
| 6:00 AM | In his room.                                                                                                                                   |
| 7:00 AM | In the [Casino](https://stardewvalleywiki.com/Casino).                                                                                         |
| 3:00 PM | In the [Oasis](https://stardewvalleywiki.com/Oasis).                                                                                           |
| 9:00 PM | Goes to the [Beach](https://stardewvalleywiki.com/The_Beach) to participate in the [Night Market](https://stardewvalleywiki.com/Night_Market). |

**Winter 28 (After seeing Mr. Qi's 6 heart event)**

| Time     | Location                                                                                                                                                  |
|----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------|
| 6:00 AM  | In his room.                                                                                                                                              |
| 12:00 PM | Goes to the [Oasis](https://stardewvalleywiki.com/Oasis)                                                                                                  |
| 6:00 PM  | Goes to the [Desert](https://stardewvalleywiki.com/The_Desert) and stands next to the bench at the [Oasis](https://stardewvalleywiki.com/Oasis) entrance. |
| 8:00 PM  | Still in the [Desert](https://stardewvalleywiki.com/The_Desert), he stands in front of the bones of the Sand Dragon.                                      |
| 11:00 PM | Goes to [Pelican Town](https://stardewvalleywiki.com/Pelican_Town) and stands in front of Mona's grave.                                                   |

## Gift Tastes
Now Mr. Qi has his own gift tastes, see the table below:

| Gift Taste 	| Items                                                                                                                                                                                                                                                                                                                                                                                                                          	|
|------------	|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------	|
| Love       	| [Life Elixir](https://stardewvalleywiki.com/Life_Elixir), [Dinosaur Egg](https://stardewvalleywiki.com/Dinosaur_Egg), [Fried Mushroom](https://stardewvalleywiki.com/Fried_Mushroom), [Miner's Treat](https://stardewvalleywiki.com/Miner%27s_Treat), [Squid](https://stardewvalleywiki.com/Squid), [Star Shards](https://stardewvalleywiki.com/Star_Shards), [Radioactive Bar](https://stardewvalleywiki.com/Radioactive_Bar) 	|
| Like       	| [Pancakes](https://stardewvalleywiki.com/Pancakes), [Lava Eel](https://stardewvalleywiki.com/Lava_Eel), [Midnight Squid](https://stardewvalleywiki.com/Midnight_Squid),[Tom Kha Soup](https://stardewvalleywiki.com/Tom_Kha_Soup), [Spicy Eel](https://stardewvalleywiki.com/Spicy_Eel), [Ginger Ale](https://stardewvalleywiki.com/Ginger_Ale)                                                                                	|
| Dislike    	| All cooking items (except Fried Mushroom, Pancakes, Tom Kha Soup, Spicy Eel, Ginger Ale, Coffee, Triple Shot Expresso and Escargot), Artisan Goods items                                                                                                                                                                                                                                                                       	|
| Hate       	| [Escargot](https://stardewvalleywiki.com/Escargot), [Triple Shot Expresso](https://stardewvalleywiki.com/Triple_Shot_Espresso), [Coffee](https://stardewvalleywiki.com/Coffee), [Wine (any tipe)](https://stardewvalleywiki.com/Wine), [Beer](https://stardewvalleywiki.com/Beer), [Pale Ale](https://stardewvalleywiki.com/Pale_Ale)                                                                                          	|
| Neutral    	| Fishes, Minerals and Gems                                                                                                                                                                                                                                                                                                                                                                                                      	|

# Known Errors
<details>
	<summary>Bug fixed in update 0.4.0-alpha.1, released on October 16, 2023.</summary>

When opening the game for the first time (or at the beginning of each day), if you open the SMAPI console, you will encounter an error similar to this:

 `[ERROR game] Failed parsing schedule for NPC Mister Qi:
0 QiNutRoom 5 2 1/1920 QiNutRoom 7 4 0 mrqi_staring/2400 QiNutRoom 5 2 1
ArgumentException: In warpCharacter, the character's currentLocation must not be null
   at StardewValley.Game1.warpCharacter(NPC character, GameLocation targetLocation, Vector2 position)
   at StardewValley.NPC.parseMasterSchedule_Patch1(NPC this, String rawData)`
  
This error happens because there are 2 "Mister Qi" in the game, each with a different internal name. One of them has the internal name set to "Mister Qi". This Mister Qi cannot be turned into a giftable NPC (i.e. it's not possible to befriend him), but apparently he can have a schedule, even if the SMAPI console returns an error. In my tests even with this error, the schedule works normally, this error can be ignored, at least for now. I still don't know how to fix this error, but I'm studying ways to solve it as soon as possible.

</details>

Actually, there's no known errors in this mod. If you find any bugs, please report on Nexus Mods [bugs](https://www.nexusmods.com/stardewvalley/mods/16724?tab=bugs) page.
