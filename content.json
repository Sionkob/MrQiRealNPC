{
    "Format": "2.6.0",
    "ConfigSchema": {
        "Kid_or_Name": {
            "AllowValues": "Name, Kid",
            "Default": "Name",
            "Description": "Change the way Mr. Qi will treat you. He may refer to you as 'Kid' or your name. Default is your name."
        }
    },
    "DynamicTokens": [
        {
            "Name": "NameOrKid",
            "Value": "{{i18n:KidOrNameToken.NameOption}}",
            "When": {
                "Kid_or_Name": "Name"
            }
        },
        {
            "Name": "NameOrKid",
            "Value": "{{i18n:KidOrNameToken.KidOption}}",
            "When": {
                "Kid_or_Name": "Kid"
            }
        },
        {
            "Name": "Qi",
            "Value": "{{ModID}}-Qi"
        },
        {
            "Name": "NGQi",
            "Value": "{{ModID}}-NonGiftableQi"
        },
        {
            "Name": "AlienName",
            "Value": "{{i18n:AlienNameToken.Option1}}",
            "When": {
                "HasFlag": "AlienNameOption1"
            }
        },
        {
            "Name": "AlienName",
            "Value": "{{i18n:AlienNameToken.Option2}}",
            "When": {
                "HasFlag": "AlienNameOption2"
            }
        },
        {
            "Name": "AlienName",
            "Value": "{{i18n:AlienNameToken.Option3}}",
            "When": {
                "HasFlag": "AlienNameOption3"
            }
        },
        {
            "Name": "AlienName",
            "Value": "{{i18n:AlienNameToken.Option4}}",
            "When": {
                "HasFlag": "AlienNameOption4"
            }
        },
        {
            "Name": "AlienName",
            "Value": "{{i18n:AlienNameToken.Option5}}",
            "When": {
                "HasFlag": "AlienNameOption5"
            }
        },
        {
            "Name": "AlienName",
            "Value": "{{i18n:AlienNameToken.FallbackValue}}",
            "When": {
                "HasFlag |contains=AlienNameOption1, AlienNameOption2, AlienNameOption3, AlienNameOption4, AlienNameOption5": "false"
            }
        }
    ],
    "Changes": [
        //NPC Basic Informations
        {
            "Action": "Include",
            "FromFile": "Data/NPCBasicInfo/NPCBasics.json"
        },
        //Mr. Qi's Dialogue
        {
            "Action": "Load",
            "Target": "Characters/Dialogue/{{ModID}}-Qi",
            "FromFile": "Data/Empty.json"
        },
        {
            "Action": "Include",
            "FromFile": "Data/Dialogue/Qi.json"
        },
        //Mr. Qi's Marriage Dialogue
        {
            "Action": "Load",
            "Target": "Characters/Dialogue/MarriageDialogue{{ModID}}-Qi",
            "FromFile": "Data/Empty.json"
        },
        {
            "Action": "Include",
            "FromFile": "Data/Dialogue/MarriageDialogueQi.json"
        },
        //Non-giftable Mr.Qi's Dialogue
        {
            "Action": "Load",
            "Target": "Characters/Dialogue/{{ModID}}-NonGiftableQi",
            "FromFile": "Data/Empty.json"
        },
        {
            "Action": "Include",
            "FromFile": "Data/Dialogue/NonGiftableQiDialogue.json"
        },
        //Other NPCs Dialogue
        {
            "Action": "Include",
            "FromFile": "Data/Dialogue/OtherNPCsDialogue.json"
        },
        //Schedule
        {
            "Action": "Load",
            "Target": "Characters/schedules/{{ModID}}-Qi",
            "FromFile": "Data/Empty.json"
        },
        {
            "Action": "Include",
            "FromFile": "Data/Schedules/Qi.json"
        },
        //Schedule Strings
        {
            "Action": "Load",
            "Target": "Strings/schedules/{{ModID}}-Qi",
            "FromFile": "Data/Empty.json"
        },
        {
            "Action": "Include",
            "FromFile": "Data/Strings/ScheduleStrings.json"
        },
        //Map Strings
        {
            "Action": "Include",
            "FromFile": "Data/Strings/MapStrings.json"
        },
        //Generic Strings
        {
            "Action": "Include",
            "FromFile": "Data/Strings/StringsFromCSFiles.json"
        },
        //Events
        {
            "Action": "Load",
            "Target": "Data/Events/Club, Data/Events/SkullCave, Data/Events/Custom_MrQiReal_QiRoom, Data/Events/Custom_MrQiReal_QiLab, Data/Events/IslandSouthEastCave, Data/Events/IslandSouthEast",
            "FromFile": "Data/Empty.json"
        },
        {
            "Action": "Include",
            "FromFile": "Data/Events/Events.json"
        },
        //Festival Locations
        {
            "Action": "Include",
            "FromFile": "Data/FestivalData/FestivalLocations.json"
        },
        //Festival Dialogue
        {
            "Action": "Include",
            "FromFile": "Data/FestivalData/FestivalDialogue.json"
        },
        //Movies Reactions
        {
            "Action": "Include",
            "FromFile": "Data/MovieTheaterData/MoviesReactions.json"
        },
        //Concession Tastes
        {
            "Action": "Include",
            "FromFile": "Data/MovieTheaterData/ConcessionTastes.json"
        },
        //Letters
        {
            "Action": "Include",
            "FromFile": "Data/MailData/MailLettersData.json"
        },
        //Quests
        {
            "Action": "Include",
            "FromFile": "Data/QuestData/Quests.json"
        },
        //Animation Descriptions
        {
            "LogName": "Mister Qi Animations",
            "Action": "EditData",
            "Target": "Data/animationDescriptions",
            "Entries": {
                "sionkob.mrqireal-qi_staring": "20/20/20",
                "sionkob.mrqireal-qi_sleep": "51/51/51"
            }
        },
        //Temporary Actors for Events
        {
            "LogName": "Temporary Actors Sprites",
            "Action": "Load",
            "Target": "Characters/{{ModID}}-Box_1, Characters/{{ModID}}-Box_2",
            "FromFile": "Assets/{{TargetPathOnly}}/Sionkob.MrQiReal-Box.png"
        },
        {
            "LogName": "Temporary Pirates Sprites",
            "Action": "Load",
            "Target": "Characters/{{ModID}}-PiratesCapitain, Characters/{{ModID}}-RedPirate, Characters/{{ModID}}-GreenPirate",
            "FromFile": "Assets/{{TargetPathOnly}}/{{TargetWithoutPath}}.png"
        },
        //Map Edits
        {
            "LogName": "Extend Casino Map",
            "Action": "EditMap",
            "Target": "Maps/Club",
            "FromFile": "Assets/Maps/ClubExtension.tmx",
            "FromArea": { "X": 0, "Y": 0, "Width": 10, "Height": 14 },
            "ToArea": { "X": 27, "Y": 0, "Width": 10, "Height": 14 },
            "PatchMode": "Replace"
        },
        {
            "LogName": "Casino Map Warps",
            "Action": "EditMap",
            "Target": "Maps/Club",
            "AddWarps": [
                "35 4 Custom_MrQiReal_QiRoom 26 27"
            ],
            "MapProperties": {
                "Doors": "35 7 z_interior 120"
            },
            "MapTiles": [
                {
                    "Layer": "Buildings",
                    "Position": { "X": 35, "Y": 7 },
                    "SetProperties": {
                        "Action": "Door {{ModID}}-Qi"
                    }
                }
            ]
        },
        {
            "LogName": "Bouncer prevents you from entering Mr. Qi's room",
            "Action": "EditMap",
            "Target": "Maps/Club",
            "MapTiles": [
                {
                    "Layer": "Buildings",
                    "Position": { "X": 35, "Y": 7 },
                    "SetProperties": {
                        "Action": "NPCMessage {{ModID}}-Bouncer \"Strings\\StringsFromCSFiles:{{ModID}}.NoEnter\""
                    }
                }
            ],
            "When": {
                "Query: {{Hearts:{{ModID}}-Qi}} < 2": true,
                "LocationName": "SandyHouse, Club"
            },
            "Update": "OnLocationChange"
        },
        {
            "LogName": "Qi Room Map Edits",
            "Action": "EditMap",
            "Target": "Maps/Custom_MrQiReal_QiRoom",
            "AddWarps": [
                "11 8 Custom_MrQiReal_QiLab 9 23",
                "26 28 Club 35 5"
            ],
            "MapProperties": {
                "Doors": "11 10 1 120"
            },
            "MapTiles": [
                {
                    "Layer": "Buildings",
                    "Position": { "X": 11, "Y": 10 },
                    "SetProperties": {
                        "Action": "Door"
                    }
                }
            ]
        },
        {
            "LogName": "Open bottom drawer after seen 2 hearts event in romance route",
            "Action": "EditMap",
            "Target": "Maps/Custom_MrQiReal_QiRoom",
            "MapTiles": [
                {
                    "Layer": "Buildings",
                    "Position": { "X": 25, "Y": 5 },
                    "SetProperties": {
                        "Action": null
                    } 
                },
                {
                    "Layer": "Buildings",
                    "Position": { "X": 25, "Y": 5 },
                    "SetProperties": {
                        "Action": "Letter MrQiRealNPC_MonasDiary"
                    }
                }
            ],
            "When": {
                "HasSeenEvent": "07.MrQiRealNPC.ARestart"
            }
        },
        {
            "LogName": "Lock laboratory door",
            "Action": "EditMap",
            "Target": "Maps/Custom_MrQiReal_QiRoom",
            "MapTiles": [
                {
                    "Layer": "Buildings",
                    "Position": { "X": 11, "Y": 10 },
                    "SetProperties": {
                        "Action": "ConditionalDoor PLAYER_HEARTS Current {{ModID}}-Qi 6"
                    }
                },
                {
                    "Layer": "Back",
                    "Position": { "X": 11, "Y": 10 },
                    "SetProperties": {
                        "TouchAction": "ConditionalDoor PLAYER_HEARTS Current {{ModID}}-Qi 6"
                    }
                },
                {
                    "Layer": "Buildings",
                    "Position": { "X": 11, "Y": 10 },
                    "SetProperties": {
                        "LockedDoorMessage": "Strings\\\\StringsFromCSFiles:{{ModID}}.QiLabDoor"
                    }
                }
            ],
            "When": {
                "HasFlag| contains=RomanceableQiRoute": "false",
                "LocationName": "Club, Custom_MrQiReal_QiRoom"
            },
            "Update": "OnLocationChange"
        },
        {
            "LogName": "Sleep on Mr. Qi's bed if dating with him",
            "Action": "EditMap",
            "Target": "Maps/Custom_MrQiReal_QiRoom",
            "MapTiles": [
                {
                    "Layer": "Back",
                    "Position": { "X": 21, "Y": 5 },
                    "SetProperties": {
                        "Bed": "T",
                        "TouchAction": "Sleep"
                    }
                }
            ],
            "When": {
                "Relationship:{{ModID}}-Qi": "Dating"
            }
        },
        {
            "LogName": "Always open Oasis",
            "Action": "EditMap",
            "Target": "Maps/Desert",
            "MapTiles": [
                {
                    "Layer": "Buildings",
                    "Position": { "X": 6, "Y": 51 },
                    "SetProperties": {
                        "Action": null
                    }
                },
                {
                    "Layer": "Buildings",
                    "Position": { "X": 6, "Y": 51 },
                    "SetProperties": {
                        "Action": "Warp 4 9 SandyHouse"
                    }
                }
            ],
            "When": {
                "HasFlag |contains={{ModID}}-AlwaysOpenOasis": "true"
            }
        },
        {
            "LogName": "Fix Mr. Qi's mini lab map warp depending on the vanilla farm type - Default for most farm types",
            "Action": "EditMap",
            "Target": "Maps/Custom_MrQiReal_QiMiniLab",
            "MapProperties": {
                "Warp": "4 11 Farm 70 10"
            },
            "When": {
                "FarmMapAsset": "Farm, Farm_Mining, Farm_Combat, Farm_Fishing, Farm_Foraging, Farm_FourCorners"
            }
        },
        {
            "LogName": "Fix Mr. Qi's mini lab map warp depending on the vanilla farm type - For Meadowlands farm",
            "Action": "EditMap",
            "Target": "Maps/Custom_MrQiReal_QiMiniLab",
            "MapProperties": {
                "Warp": "4 11 Farm 89 9"
            },
            "When": {
                "FarmMapAsset": "Farm_Ranching"
            }
        },
        {
            "LogName": "Fix Mr. Qi's mini lab map warp depending on the vanilla farm type - For Beach farm",
            "Action": "EditMap",
            "Target": "Maps/Custom_MrQiReal_QiMiniLab",
            "MapProperties": {
                "Warp": "4 11 Farm 80 6"
            },
            "When": {
                "FarmMapAsset": "Farm_Island"
            }
        },
        //Custom Locations
        {
            "LogName": "Load Maps",
            "Action": "Load",
            "Target": "Maps/Custom_MrQiReal_QiRoom, Maps/Custom_MrQiReal_QiLab, Maps/MrQiReal-IslandCave_pirates, Maps/MrQiReal_EmptyMap, Maps/Custom_MrQiReal_QiSpouseRoom, Maps/Custom_MrQiReal_QiSpousePatio, Maps/Custom_MrQiReal_QiMiniLab",
            "FromFile": "Assets/Maps/{{TargetWithoutPath}}.tmx"
        },
        {
            "LogName": "Add Maps",
            "Action": "EditData",
            "Target": "Data/Locations",
            "Entries": {
                "Custom_MrQiReal_QiRoom": {
                    "DisplayName": "{{i18n:Location.QiRoom}}",
                    "DefaultArrivalTile": {
                        "X": 26, 
                        "Y": 27
                    },
                    "CreateOnLoad": {
                        "MapPath": "Maps/Custom_MrQiReal_QiRoom"
                    }
                },
                "Custom_MrQiReal_QiLab": {
                    "DisplayName": "{{i18n:Location.QiLab}}",
                    "DefaultArrivalTile": {
                        "X": 9,
                        "Y": 22
                    },
                    "CreateOnLoad": {
                        "MapPath": "Maps/Custom_MrQiReal_QiLab"
                    }
                },
                "Custom_MrQiReal_QiMiniLab": {
                    "DisplayName": "{{i18n:Location.QiMiniLab}}",
                    "DefaultArrivalTile": {
                        "X": 4,
                        "Y": 10
                    },
                    "CreateOnLoad": {
                        "MapPath": "Maps/Custom_MrQiReal_QiMiniLab"
                    }
                }
            }
        }
    ]
}
